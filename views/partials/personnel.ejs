<div class="col-sm-3">
    <div class="well">
      <!-- <div style="padding-right: 5%; float: right;">
      </div> -->
      <div class="card">
        <div class="card-body" style="overflow-y: scroll;">
          <h1 class="card-title">Personnel - <%= personnel.length %>

          <button class="btn border-secondary-subtle" data-bs-toggle="modal" data-bs-target="#personnelModal">ADD +</button>
        
        
        <!-- Modal -->
        <div class="modal fade" id="personnelModal" tabindex="-1" aria-labelledby="personnelModalLabel" aria-hidden="true">
          <div class="modal-dialog">

          <form action="/projects" method="POST">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="personnelModalLabel">Add Person</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <label for="fName">First name:</label>
                <input type="text" id="fName" name="fName"><br><br>
                <label for="lName">Last name:</label>
                <input type="text" id="lName" name="lName"><br><br>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            </div>
          </form>

          </div>
        </div>

</h1>
          <hr><h5 class="card-title">Assigned</h5>
          <div class="card-body bg-secondary-subtle" id="cont">

      
          <% personnel.forEach(function(person) { if (person.projects) {%>
            <button draggable="True" type="button" style="width: 100%; text-align: left; position: relative; z-index: 1000" 
              class="btn bg-light border-secondary-subtle" 
              data-bs-toggle="popover"  
              title= "Info for <%=person.firstName%> <%=person.lastName%>" 
              data-bs-placement="left"  
              data-bs-content="INSERT PROJECT NAMES HERE">
              
              <strong><%= person.firstName+' '+person.lastName %></strong>
                  <% 
                    // count how many projects each person has and determine their color
                    let total = 0;
                      person.projects.forEach(function(project) { 
                        total+= project.weight;
                      })

                    let color;
                    if (total < 1) {
                      color='primary';
                    } else if (total < 2) {
                      color='success';
                    }
                    else if (total < 3) {
                      color='warning';
                    } else {
                      color='danger';
                    } 
                  %>

                  <span class="badge bg-<%=color%>" style="float: right;">
                    <%= total %>
                  </span></button>
            <% }}); %>
          </div>
            <hr><h5 class="card-title">Unassigned</h5>
            <div class="card-body bg-secondary-subtle">
            <% personnel.forEach(function(person) { if (person.projects) {} else{ %>
              <button draggable="True" style="width: 100%; text-align: left;"
                class="btn bg-light border-secondary-subtle"
                data-bs-toggle="popover"  
                title= "Info for <%=person.firstName%> <%=person.lastName%>" 
                data-bs-placement="left"  
                data-bs-content="No projects assigned."><strong>
                  <%= person.firstName+' '+person.lastName %></strong>
                    <span class="badge bg-primary" style="float: right;">
                      0
                    </span></button>
              <% }}); %>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
  var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
    return new bootstrap.Popover(popoverTriggerEl)
  })
 
  var myModal = document.getElementById('exampleModal')
  var myInput = document.getElementById('myInput')

  myModal.addEventListener('shown.bs.modal', function () {
    myInput.focus()
  })
  </script>